# 4DSplat Project Rules

## Project Overview
4DSplat is a pipeline for converting video files into 3D Gaussian splats and rendering stereo images. The project processes video frames through ml-sharp to generate PLY files containing Gaussian splat representations, then renders stereo images from those splats.

## Key Technologies
- **ml-sharp**: Used for converting video frames to Gaussian splats (installed from ~/projects/Splat-R&D/ml-sharp)
- **OpenCV**: Video processing and frame extraction
- **plyfile**: PLY file manipulation (optional, for downsampling)
- **Open3D**: Open-source library for 3D data processing (point clouds, meshes, visualization)
- **Python**: Main language for the pipeline

## Project Structure
- `video_to_splats.py`: Converts video frames to PLY files using ml-sharp
- `render_stereo_images_cpu.py`: Renders stereo images from PLY files
- `render_stereo_images.py`: Alternative GPU-based renderer
- `run.py`: Main pipeline runner with configurable options
- `ply_frames/`: Output directory for PLY files
- `stereo_output/`: Output directory for rendered stereo images

## Splat Format Tools
- **splat-transform**: CLI tool for 3D Gaussian splat format conversion and transformation
  - Repository: https://github.com/playcanvas/splat-transform
  - Supports format conversion (PLY, CSV, SPLAT, KSPLAT, SOG)
  - Provides transformations (scale, translate, rotate)
  - Filtering capabilities (NaN removal, opacity filtering, harmonic filtering)
  - Can be used for post-processing PLY files generated by this pipeline
  - Library API available for programmatic use

## Rendering and Visualization Tools
- **PlayCanvas Engine**: Open-source web graphics runtime for rendering 3D content
  - Repository: https://github.com/playcanvas/engine
  - Built on WebGL, WebGPU, WebXR and glTF
  - Supports 2D + 3D graphics, animation, physics, and more
  - Can be used for web-based visualization of Gaussian splats
  - TypeScript/JavaScript API

## Common Workflows
1. **Video to Splats**: Extract frames from video and convert to PLY files
2. **Render Stereo**: Generate left/right/center stereo images from PLY files
3. **Full Pipeline**: Run both steps sequentially

## Default Configuration
- Input video: `input.MOV`
- PLY output: `ply_frames/`
- Stereo output: `stereo_output/`
- Interpupillary distance: 0.063 meters
- Frame interval: 1 (process every frame)

## Device Options
- `default`: Auto-detect best device
- `cuda`: NVIDIA GPU
- `mps`: Apple Silicon GPU
- `cpu`: CPU fallback

## Code Style
- Use Python 3
- Follow PEP 8 style guidelines
- Keep descriptions short and concise
- Do not remove commented out code unless explicitly asked

## Notes
- PLY files contain 3D Gaussian splat representations
- Files are named like `frame_000000.ply`, `frame_000001.ply`, etc.
- Downsampling reduces file size by ~50% by removing every other point
- The pipeline supports processing every Nth frame for faster processing

